<template><div><ul>
<li><a href="http://nsddd.top" target="_blank" rel="noopener noreferrer">author<ExternalLinkIcon/></a></li>
</ul>
<h1 id="ç¬¬79èŠ‚-openim-ä½¿ç”¨-harbor-æ­å»ºä¼ä¸šçº§é•œåƒä»“åº“" tabindex="-1"><a class="header-anchor" href="#ç¬¬79èŠ‚-openim-ä½¿ç”¨-harbor-æ­å»ºä¼ä¸šçº§é•œåƒä»“åº“" aria-hidden="true">#</a> ç¬¬79èŠ‚ OpenIM ä½¿ç”¨ Harbor æ­å»ºä¼ä¸šçº§é•œåƒä»“åº“</h1>
<div><a href = '78.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '80.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>
<blockquote>
<p>â¤ï¸ğŸ’•ğŸ’•æ–°æ—¶ä»£æ‹¥æŠ±äº‘åŸç”Ÿï¼Œäº‘åŸç”Ÿå…·æœ‰ç¯å¢ƒç»Ÿä¸€ã€æŒ‰éœ€ä»˜è´¹ã€å³å¼€å³ç”¨ã€ç¨³å®šæ€§å¼ºç‰¹ç‚¹ã€‚Myblog:<a href="http://nsddd.top/" target="_blank" rel="noopener noreferrer">http://nsddd.top<ExternalLinkIcon/></a></p>
</blockquote>
<hr>
<p>[TOC]</p>
<h2 id="éœ€æ±‚" tabindex="-1"><a class="header-anchor" href="#éœ€æ±‚" aria-hidden="true">#</a> éœ€æ±‚</h2>
<p>OpenIM æä¾›äº†å¤šç§å…¬å…±çš„é•œåƒæ³¨å†Œåœ°å€ï¼Œæ¯”å¦‚è¯´ aliyunï¼Œ githubï¼Œ Docker hub ~</p>
<p>é˜…è¯» https://github.com/openimsdk/open-im-server/blob/main/docs/conversions/images.md è·å–æ›´å¤šçš„é•œåƒæ„å»ºæŒ‡å—ã€‚</p>
<p>å¤§éƒ¨åˆ†ä¼ä¸šéƒ½ä¼šé€‰æ‹©è‡ªå·±åšé•œåƒä»“åº“ï¼Œä½¿ç”¨ Harbor æ¥æ­å»ºä¼ä¸šçº§çš„é•œåƒä»“åº“ï¼Œå°†å®ƒé›†æˆ CICD Pipeline æµç¨‹ä¸­ï¼Œæœ€ç»ˆæ›¿æ¢ Docker Hubï¼Œè¿›ä¸€æ­¥é™ä½é•œåƒå­˜å‚¨çš„æˆæœ¬ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼ŒHarbor ä¸€èˆ¬éƒ½ä¼šå¼€å¯ TLSï¼Œæ‰€ä»¥ä½ è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªå¯ç”¨çš„åŸŸåã€‚</p>
<blockquote>
<p>ä¸­å›½çš„æœåŠ¡å™¨ä½¿ç”¨åŸŸåï¼Œéœ€è¦å¯¹åŸŸåè¿›è¡Œå¤‡æ¡ˆ</p>
</blockquote>
<h2 id="å®‰è£…-helm" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-helm" aria-hidden="true">#</a> å®‰è£… Helm</h2>
<p>Helmï¼Œä»¥åŠ é›†ç¾¤çš„éƒ¨ç½²å‚è€ƒ https://github.com/openimsdk/open-im-server/tree/main/deployments</p>
<h2 id="å®‰è£…-cert-manager" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-cert-manager" aria-hidden="true">#</a> å®‰è£… Cert-manager</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å®‰è£… Cert-managerï¼Œå®ƒä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨ç­¾å‘å…è´¹çš„ Letâ€™s Encrypt HTTPS è¯ä¹¦ï¼Œå¹¶åœ¨è¿‡æœŸå‰è‡ªåŠ¨ç»­æœŸã€‚</p>
<p>é¦–å…ˆï¼Œè¿è¡Œ helm repo add å‘½ä»¤æ·»åŠ å®˜æ–¹ Helm ä»“åº“ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo <span class="token function">add</span> jetstack https://charts.jetstack.io
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åï¼Œè¿è¡Œ helm repo update æ›´æ–°æœ¬åœ°ç¼“å­˜ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œè¿è¡Œ helm install æ¥å®‰è£… Cert-managerã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm <span class="token function">install</span> cert-manager jetstack/cert-manager <span class="token punctuation">\</span>
<span class="token parameter variable">--namespace</span> cert-manager <span class="token punctuation">\</span>
--create-namespace <span class="token punctuation">\</span>
<span class="token parameter variable">--version</span> v1.10.0 <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerName</span><span class="token operator">=</span>letsencrypt-prod <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerKind</span><span class="token operator">=</span>ClusterIssuer <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerGroup</span><span class="token operator">=</span>cert-manager.io <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">installCRDs</span><span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œè¿˜éœ€è¦ä¸º Cert-manager åˆ›å»º ClusterIssuerï¼Œç”¨æ¥æä¾›ç­¾å‘æœºæ„ã€‚å°†ä¸‹é¢çš„å†…å®¹ä¿å­˜ä¸º <code v-pre>cluster-issuer.yaml</code>ã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> cert<span class="token punctuation">-</span>manager.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterIssuer
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>prod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">acme</span><span class="token punctuation">:</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//acme<span class="token punctuation">-</span>v02.api.letsencrypt.org/directory
    <span class="token key atrule">email</span><span class="token punctuation">:</span> <span class="token string">"cubxxw@openim.io"</span>
    <span class="token key atrule">privateKeySecretRef</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>prod
    <span class="token key atrule">solvers</span><span class="token punctuation">:</span>    
    <span class="token punctuation">-</span> <span class="token key atrule">http01</span><span class="token punctuation">:</span>
        <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
          <span class="token key atrule">class</span><span class="token punctuation">:</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œè¿™é‡Œä½ éœ€è¦å°† <code v-pre>spec.acme.email</code> æ›¿æ¢ä¸ºä½ çœŸå®çš„é‚®ç®±åœ°å€ã€‚ç„¶åè¿è¡Œ kubectl apply æäº¤åˆ°é›†ç¾¤å†…ã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code>$ kubectl apply <span class="token punctuation">-</span>f cluster<span class="token punctuation">-</span>issuer.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="å®‰è£…å’Œé…ç½®-harbor" tabindex="-1"><a class="header-anchor" href="#å®‰è£…å’Œé…ç½®-harbor" aria-hidden="true">#</a> å®‰è£…å’Œé…ç½® Harbor</h2>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨ Helm æ¥å®‰è£… Harborï¼Œé¦–å…ˆæ·»åŠ  Harbor å®˜æ–¹ä»“åº“ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo <span class="token function">add</span> harbor https://helm.goharbor.io
$ helm repo update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œç”±äºæˆ‘ä»¬éœ€è¦å®šåˆ¶åŒ–å®‰è£… Harborï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ Harbor çš„å®‰è£…å‚æ•°ï¼Œå°†ä¸‹é¢çš„å†…å®¹ä¿å­˜ä¸º <code v-pre>values.yaml</code>ã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code><span class="token key atrule">expose</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ingress
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">certSource</span><span class="token punctuation">:</span> secret
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> <span class="token string">"harbor-secret-tls"</span>
      <span class="token key atrule">notarySecretName</span><span class="token punctuation">:</span> <span class="token string">"notary-secret-tls"</span>
  <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
    <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
      <span class="token key atrule">core</span><span class="token punctuation">:</span> harbor.openim.io
      <span class="token key atrule">notary</span><span class="token punctuation">:</span> notary.openim.io
    <span class="token key atrule">className</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
      <span class="token key atrule">kubernetes.io/tls-acme</span><span class="token punctuation">:</span> <span class="token string">"true"</span>
<span class="token key atrule">persistence</span><span class="token punctuation">:</span>
  <span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation">:</span>
    <span class="token key atrule">registry</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 20Gi
    <span class="token key atrule">chartmuseum</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
    <span class="token key atrule">jobservice</span><span class="token punctuation">:</span>
      <span class="token key atrule">jobLog</span><span class="token punctuation">:</span>
        <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
      <span class="token key atrule">scanDataExports</span><span class="token punctuation">:</span>
        <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
    <span class="token key atrule">database</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
    <span class="token key atrule">redis</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
    <span class="token key atrule">trivy</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œæˆ‘è¿˜ä¸º Harbor é…ç½®äº† ingress è®¿é—®åŸŸåï¼Œåˆ†åˆ«æ˜¯ <code v-pre>harbor.openim.io</code> å’Œ <code v-pre>notary.openim.io</code>ï¼Œä½ éœ€è¦å°†å®ƒä»¬åˆ†åˆ«æ›¿æ¢æˆä½ çš„çœŸå®åŸŸåã€‚</p>
<p>ç„¶åï¼Œå†é€šè¿‡ helm install å‘½ä»¤æ¥å®‰è£… Harborï¼Œå¹¶æŒ‡å®šå‚æ•°é…ç½®æ–‡ä»¶ values.yamlã€‚</p>
<blockquote>
<p><strong>Note</strong></p>
<p>å¦‚æœ OpenIM é›†ç¾¤éƒ¨ç½²çš„ å‘½åç©ºé—´ æ˜¯ <code v-pre>openim</code>ï¼Œ é‚£ä¹ˆéœ€è¦ä½¿ç”¨ <code v-pre>-n</code> æŒ‡å®šå‘½åç©ºé—´ã€‚å¦‚æœå‘½åç©ºé—´ä¸å­˜åœ¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code v-pre>--create-namespace</code> chaun'jian</p>
</blockquote>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code>$ helm install harbor harbor/harbor <span class="token punctuation">-</span>f values.yaml <span class="token punctuation">-</span><span class="token punctuation">-</span>namespace harbor <span class="token punctuation">-</span><span class="token punctuation">-</span>create<span class="token punctuation">-</span>namespace
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç­‰å¾…æ‰€æœ‰ Pod å¤„äºå°±ç»ªçŠ¶æ€ã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code>$ kubectl wait <span class="token punctuation">-</span><span class="token punctuation">-</span>for=condition=Ready pods <span class="token punctuation">-</span><span class="token punctuation">-</span>all <span class="token punctuation">-</span>n harbor <span class="token punctuation">-</span><span class="token punctuation">-</span>timeout 600s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åˆ°è¿™é‡Œï¼ŒHarbor å°±å·²ç»å®‰è£…å®Œæˆäº†ã€‚</p>
<h3 id="é…ç½®-dns-è§£æ" tabindex="-1"><a class="header-anchor" href="#é…ç½®-dns-è§£æ" aria-hidden="true">#</a> é…ç½® DNS è§£æ</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºåŸŸåé…ç½® DNS è§£æã€‚é¦–å…ˆï¼Œè·å– Ingress-Nginx Loadbalancer çš„å¤–ç½‘ IPã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code>$ kubectl get services <span class="token punctuation">-</span><span class="token punctuation">-</span>namespace ingress<span class="token punctuation">-</span>nginx ingress<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>controller <span class="token punctuation">-</span><span class="token punctuation">-</span>output jsonpath='<span class="token punctuation">{</span>.status.loadBalancer.ingress<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.ip<span class="token punctuation">}</span>'
43.134.63.160
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œä¸ºåŸŸåé…ç½® DNS è§£æã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘éœ€è¦åˆ†åˆ«ä¸º <code v-pre>harbor.openim.io</code> å’Œ <code v-pre>notary.openim.io</code> é…ç½® A è®°å½•ï¼Œå¹¶æŒ‡å‘ <code v-pre>43.134.63.160</code>ã€‚</p>
<h2 id="è®¿é—®-harbor-dashboard" tabindex="-1"><a class="header-anchor" href="#è®¿é—®-harbor-dashboard" aria-hidden="true">#</a> è®¿é—® Harbor Dashboard</h2>
<p>åœ¨è®¿é—® Harbor Dashboard ä¹‹å‰ï¼Œé¦–å…ˆæˆ‘ä»¬è¦ç¡®è®¤ Cert-manager æ˜¯å¦å·²ç»æˆåŠŸç­¾å‘äº† HTTPS è¯ä¹¦ï¼Œä½ å¯ä»¥é€šè¿‡ kubectl get certificate å‘½ä»¤æ¥ç¡®è®¤ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ kubectl get certificate <span class="token parameter variable">-A</span>                     
NAMESPACE   NAME                READY   SECRET              AGE
harbor      harbor-secret-tls   True    harbor-secret-tls   8s
harbor      notary-secret-tls   True    notary-secret-tls   8s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºæˆ‘ä»¬åœ¨éƒ¨ç½² Harbor çš„æ—¶å€™éœ€è¦é…ç½®ä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥è¿™é‡Œä¼šå‡ºç°ä¸¤ä¸ªè¯ä¹¦ã€‚å½“è¿™ä¸¤ä¸ªè¯ä¹¦çš„ Ready çŠ¶æ€éƒ½ä¸º True æ—¶ï¼Œè¯´æ˜ HTTPS è¯ä¹¦å·²ç»ç­¾å‘æˆåŠŸäº†ã€‚æ­¤å¤–ï¼ŒCert-manager è‡ªåŠ¨ä» Ingress å¯¹è±¡ä¸­è¯»å–äº† tls é…ç½®ï¼Œè¿˜è‡ªåŠ¨åˆ›å»ºäº†åä¸º harbor-secret-tls å’Œ notary-secret-tls ä¸¤ä¸ªåŒ…å«è¯ä¹¦ä¿¡æ¯çš„ Secretã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ <a href="https://harbor.openim.io" target="_blank" rel="noopener noreferrer">https://harbor.openim.io<ExternalLinkIcon/></a>  è¿›å…¥ Harbor Dashboardï¼Œä½¿ç”¨é»˜è®¤è´¦å· admin å’Œ Harbor12345 å³å¯ç™»å½•æ§åˆ¶å°ã€‚</p>
<h2 id="æ¨é€é•œåƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#æ¨é€é•œåƒæµ‹è¯•" aria-hidden="true">#</a> æ¨é€é•œåƒæµ‹è¯•</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥å°è¯•å°†æœ¬åœ°çš„é•œåƒæ¨é€åˆ° Harbor ä»“åº“ã€‚é¦–å…ˆï¼Œåœ¨æœ¬åœ°æ‹‰å– busybox é•œåƒã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> pull busybox
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åï¼Œè¿è¡Œ docker login å‘½ä»¤ç™»å½•åˆ° Harbor ä»“åº“ï¼Œä½¿ç”¨é»˜è®¤çš„è´¦å·å¯†ç ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> login harbor.openim.io
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œé‡æ–°ç»™ busybox é•œåƒæ‰“æ ‡ç­¾ï¼ŒæŒ‡å‘ Harbor é•œåƒä»“åº“ã€‚</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> tag busybox:latest harbor.openim.io/library/busybox:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å’Œæ¨é€åˆ° Docker Hub çš„ Tag ç›¸æ¯”ï¼Œæ¨é€åˆ° Harbor éœ€è¦æŒ‡å®šå®Œæ•´çš„é•œåƒä»“åº“åœ°å€ã€é¡¹ç›®åå’Œé•œåƒåã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨äº†é»˜è®¤çš„ library é¡¹ç›®ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶å°† library æ›¿æ¢ä¸ºæ–°çš„é¡¹ç›®åã€‚</p>
<p>æœ€åï¼Œå°†é•œåƒæ¨é€åˆ°ä»“åº“ã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code>$ docker push harbor.openim.io/library/busybox<span class="token punctuation">:</span>latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é•œåƒæ¨é€æˆåŠŸåï¼Œè®¿é—® Harbor æ§åˆ¶å°ï¼Œè¿›å…¥ library é¡¹ç›®è¯¦æƒ…ï¼Œä½ å°†çœ‹åˆ°æˆ‘ä»¬åˆšæ‰æ¨é€çš„é•œåƒã€‚</p>
<p>åˆ°è¿™é‡Œï¼ŒHarbor é•œåƒä»“åº“å°±å·²ç»é…ç½®å¥½äº†ã€‚</p>
<h2 id="æ¨èä½¿ç”¨-s3-å­˜å‚¨é•œåƒ" tabindex="-1"><a class="header-anchor" href="#æ¨èä½¿ç”¨-s3-å­˜å‚¨é•œåƒ" aria-hidden="true">#</a> æ¨èä½¿ç”¨ S3 å­˜å‚¨é•œåƒ</h2>
<p>é™¤äº†ä½¿ç”¨æŒä¹…å·æ¥å­˜å‚¨é•œåƒä»¥å¤–ï¼ŒHarbor è¿˜æ”¯æŒå¤–éƒ¨å­˜å‚¨ã€‚å¦‚æœä½ å¸Œæœ›å¤§è§„æ¨¡ä½¿ç”¨ Harbor åˆä¸æƒ³å…³æ³¨å­˜å‚¨é—®é¢˜ï¼Œé‚£ä¹ˆä½¿ç”¨å¤–éƒ¨å­˜å‚¨æ˜¯ä¸€ä¸ªéå¸¸çš„é€‰æ‹©ã€‚ä¾‹å¦‚ä½¿ç”¨ AWS S3 å­˜å‚¨æ¡¶æ¥å­˜å‚¨é•œåƒã€‚</p>
<p>S3 å­˜å‚¨æ–¹æ¡ˆçš„ä¼˜åŠ¿æ˜¯ï¼Œå®ƒèƒ½ä¸ºæˆ‘ä»¬æä¾›æ¥è¿‘æ— é™å­˜å‚¨å®¹é‡çš„å­˜å‚¨ç³»ç»Ÿï¼Œå¹¶ä¸”æŒ‰é‡è®¡è´¹çš„æ–¹å¼æˆæœ¬ä¹Ÿç›¸å¯¹å¯æ§ï¼ŒåŒæ—¶å®ƒè¿˜å…·å¤‡é«˜å¯ç”¨æ€§å’Œå®¹ç¾èƒ½åŠ›ã€‚</p>
<p>è¦ä½¿ç”¨ S3 æ¥å­˜å‚¨é•œåƒï¼Œä½ éœ€è¦åœ¨å®‰è£…æ—¶ä¿®æ”¹ Harbor çš„å®‰è£…é…ç½® values.yamlã€‚</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code><span class="token key atrule">expose</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ingress
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">certSource</span><span class="token punctuation">:</span> secret
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> <span class="token string">"harbor-secret-tls"</span>
      <span class="token key atrule">notarySecretName</span><span class="token punctuation">:</span> <span class="token string">"notary-secret-tls"</span>
  <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
    <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
      <span class="token key atrule">core</span><span class="token punctuation">:</span> harbor.openim.io
      <span class="token key atrule">notary</span><span class="token punctuation">:</span> notary.openim.io
    <span class="token key atrule">className</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
      <span class="token key atrule">kubernetes.io/tls-acme</span><span class="token punctuation">:</span> <span class="token string">"true"</span>
<span class="token key atrule">persistence</span><span class="token punctuation">:</span>
  <span class="token key atrule">imageChartStorage</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> s3
    <span class="token key atrule">s3</span><span class="token punctuation">:</span>
      <span class="token key atrule">region</span><span class="token punctuation">:</span> us<span class="token punctuation">-</span>west<span class="token punctuation">-</span><span class="token number">1</span>
      <span class="token key atrule">bucket</span><span class="token punctuation">:</span> bucketname
      <span class="token key atrule">accesskey</span><span class="token punctuation">:</span> AWS_ACCESS_KEY_ID
      <span class="token key atrule">secretkey</span><span class="token punctuation">:</span> AWS_SECRET_ACCESS_KEY
      <span class="token key atrule">rootdirectory</span><span class="token punctuation">:</span> /harbor
  <span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation">:</span>
    <span class="token key atrule">chartmuseum</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
    <span class="token key atrule">jobservice</span><span class="token punctuation">:</span>
      <span class="token key atrule">jobLog</span><span class="token punctuation">:</span>
        <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
      <span class="token key atrule">scanDataExports</span><span class="token punctuation">:</span>
        <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi
     <span class="token punctuation">...</span><span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œè¦å°† S3 ç›¸å…³é…ç½® regionã€bucketã€accesskeyã€secretkey å’Œ rootdirectory å­—æ®µä¿®æ”¹ä¸ºå®é™…çš„å€¼ã€‚ç„¶åï¼Œå†ä½¿ç”¨ <code v-pre>helm install -f values.yaml</code> æ¥å®‰è£…ã€‚</p>
<h2 id="requirements" tabindex="-1"><a class="header-anchor" href="#requirements" aria-hidden="true">#</a> Requirements</h2>
<p>OpenIM provides various public image registry addresses, such as aliyun, github, Docker Hub, and more.</p>
<p>Read https://github.com/openimsdk/open-im-server/blob/main/docs/conversions/images.md for more image building guidelines.</p>
<p>Most enterprises choose to set up their own image repository using Harbor, integrating it into their CI/CD pipeline to eventually replace Docker Hub and further reduce image storage costs.</p>
<p>Additionally, in a production environment, Harbor generally enables TLS, so you will also need to prepare a valid domain name.</p>
<blockquote>
<p>Chinese servers use domain names and require domain registration.</p>
</blockquote>
<h2 id="install-helm" tabindex="-1"><a class="header-anchor" href="#install-helm" aria-hidden="true">#</a> Install Helm</h2>
<p>Helm, along with cluster deployment references, can be found at https://github.com/openimsdk/open-im-server/tree/main/deployments.</p>
<h2 id="install-cert-manager" tabindex="-1"><a class="header-anchor" href="#install-cert-manager" aria-hidden="true">#</a> Install Cert-manager</h2>
<p>Next, let's install Cert-manager, which will automatically issue free Let's Encrypt HTTPS certificates for us and renew them before they expire.</p>
<p>First, run the following command to add the official Helm repository:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo <span class="token function">add</span> jetstack https://charts.jetstack.io
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Then, update the local cache:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Next, run the following command to install Cert-manager:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm <span class="token function">install</span> cert-manager jetstack/cert-manager <span class="token punctuation">\</span>
<span class="token parameter variable">--namespace</span> cert-manager <span class="token punctuation">\</span>
--create-namespace <span class="token punctuation">\</span>
<span class="token parameter variable">--version</span> v1.10.0 <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerName</span><span class="token operator">=</span>letsencrypt-prod <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerKind</span><span class="token operator">=</span>ClusterIssuer <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">ingressShim.defaultIssuerGroup</span><span class="token operator">=</span>cert-manager.io <span class="token punctuation">\</span>
<span class="token parameter variable">--set</span> <span class="token assign-left variable">installCRDs</span><span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally, you need to create a ClusterIssuer for Cert-manager to provide the signing authority. Save the following content as <code v-pre>cluster-issuer.yaml</code>:</p>
<div class="language-yaml ext-yml line-numbers-mode"><pre v-pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> cert<span class="token punctuation">-</span>manager.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterIssuer
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>prod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">acme</span><span class="token punctuation">:</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//acme<span class="token punctuation">-</span>v02.api.letsencrypt.org/directory
    <span class="token key atrule">email</span><span class="token punctuation">:</span> <span class="token string">"your-email@example.com"</span>
    <span class="token key atrule">privateKeySecretRef</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>prod
    <span class="token key atrule">solvers</span><span class="token punctuation">:</span>    
    <span class="token punctuation">-</span> <span class="token key atrule">http01</span><span class="token punctuation">:</span>
        <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
          <span class="token key atrule">class</span><span class="token punctuation">:</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Please replace <code v-pre>spec.acme.email</code> with your actual email address, and then apply it to the cluster:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ kubectl apply <span class="token parameter variable">-f</span> cluster-issuer.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="install-and-configure-harbor" tabindex="-1"><a class="header-anchor" href="#install-and-configure-harbor" aria-hidden="true">#</a> Install and Configure Harbor</h2>
<p>Now, we'll also use Helm to install Harbor. First, add the official Harbor repository:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm repo <span class="token function">add</span> harbor https://helm.goharbor.io
$ helm repo update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, since we need to customize the installation of Harbor, you'll need to modify Harbor's installation parameters. Save the following content as <code v-pre>values.yaml</code>:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>expose:
  type: ingress
  tls:
    enabled: <span class="token boolean">true</span>
    certSource: secret
    secret:
      secretName: <span class="token string">"harbor-secret-tls"</span>
      notarySecretName: <span class="token string">"notary-secret-tls"</span>
  ingress:
    hosts:
      core: harbor.openim.io
      notary: notary.openim.io
    className: nginx
    annotations:
      kubernetes.io/tls-acme: <span class="token string">"true"</span>
persistence:
  persistentVolumeClaim:
    registry:
      size: 20Gi
    chartmuseum:
      size: 10Gi
    jobservice:
      jobLog:
        size: 10Gi
      scanDataExports:
        size: 10Gi
    database:
      size: 10Gi
    redis:
      size: 10Gi
    trivy:
      size: 10Gi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally, I've configured ingress access domains for Harbor as <code v-pre>harbor.openim.io</code> and <code v-pre>notary.openim.io</code>. You need to replace them with your actual domain names.</p>
<p>Then, install Harbor using the following <code v-pre>helm install</code> command, specifying the configuration file <code v-pre>values.yaml</code>:</p>
<blockquote>
<p><strong>Note</strong>: If the OpenIM cluster is deployed in a namespace other than <code v-pre>openim</code>, you need to use <code v-pre>-n</code> to specify the namespace. If the namespace does not exist, you can use <code v-pre>--create-namespace</code>.</p>
</blockquote>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm <span class="token function">install</span> harbor harbor/harbor <span class="token parameter variable">-f</span> values.yaml <span class="token parameter variable">--namespace</span> harbor --create-namespace
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Wait for all pods to be in a ready state:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ kubectl <span class="token function">wait</span> <span class="token parameter variable">--for</span><span class="token operator">=</span>condition<span class="token operator">=</span>Ready pods <span class="token parameter variable">--all</span> <span class="token parameter variable">-n</span> harbor <span class="token parameter variable">--timeout</span> 600s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>At this point, Harbor has been successfully installed.</p>
<h3 id="configure-dns-resolution" tabindex="-1"><a class="header-anchor" href="#configure-dns-resolution" aria-hidden="true">#</a> Configure DNS Resolution</h3>
<p>Next, configure DNS resolution for your domain name. First, get the external IP of the Ingress-Nginx LoadBalancer:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ kubectl get services <span class="token parameter variable">--namespace</span> ingress-nginx ingress-nginx-controller <span class="token parameter variable">--output</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">'{.status.loadBalancer.ingress[0].ip}'</span>
<span class="token number">43.134</span>.63.160
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Then, configure DNS resolution for your domain names. In this example, I need to configure A records for <code v-pre>harbor.openim.io</code> and <code v-pre>notary.openim.io</code> and point them to <code v-pre>43.134.63.160</code>.</p>
<h2 id="access-harbor-dashboard" tabindex="-1"><a class="header-anchor" href="#access-harbor-dashboard" aria-hidden="true">#</a> Access Harbor Dashboard</h2>
<p>Before accessing the Harbor Dashboard, first confirm whether Cert-manager has successfully issued the HTTPS certificate. You can use the <code v-pre>kubectl get certificate</code> command to check:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ kubectl get certificate <span class="token parameter variable">-A</span>                     
NAMESPACE   NAME                READY   SECRET              AGE
harbor      harbor-secret-tls   True    harbor-secret-tls   8s
harbor      notary-secret-tls   True    notary-secret-tls   8s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Since we configured two domains when deploying Harbor, you will see two certificates here. When both certificates have a <code v-pre>Ready</code> status of <code v-pre>True</code>, it means that the HTTPS certificates have been successfully issued. Additionally, Cert-manager automatically reads the tls configuration from the Ingress object and creates two secrets, <code v-pre>harbor-secret-tls</code> and <code v-pre>notary-secret-tls</code>, containing certificate information.</p>
<p>Next, open <a href="https://harbor.openim.io/" target="_blank" rel="noopener noreferrer">https://harbor.openim.io<ExternalLinkIcon/></a> to access the Harbor Dashboard. You can log in to the console using the default account <code v-pre>admin</code> and password <code v-pre>Harbor12345</code>.</p>
<h2 id="test-image-push" tabindex="-1"><a class="header-anchor" href="#test-image-push" aria-hidden="true">#</a> Test Image Push</h2>
<p>Now, let's try pushing a local image to the Harbor repository. First, pull the busybox image locally:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> pull busybox
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Then, run the <code v-pre>docker login</code> command to log in to the Harbor repository using the default credentials:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> login harbor.openim.io
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Next, re-tag the busybox image to point to the Harbor image repository:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> tag busybox:latest harbor.openim.io/library/busybox:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Compared to pushing to Docker Hub, pushing to Harbor requires specifying the full image repository address, project name, and image name. Here, I used the default <code v-pre>library</code> project, but you can create a new project and replace <code v-pre>library</code> with the new project name.</p>
<p>Finally, push the image to the repository:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">docker</span> push harbor.openim.io/library/busybox:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After successfully pushing the image, visit the Harbor console, go to the <code v-pre>library</code> project details, and you will see theimage that we just pushed.</p>
<p>At this point, your Harbor image repository is configured and operational.</p>
<h2 id="recommended-use-s3-storage-for-images" tabindex="-1"><a class="header-anchor" href="#recommended-use-s3-storage-for-images" aria-hidden="true">#</a> Recommended: Use S3 Storage for Images</h2>
<p>In addition to using persistent volumes for image storage, Harbor also supports external storage. If you want to use Harbor extensively and don't want to worry about storage, using external storage is an excellent choice. For example, you can use an AWS S3 bucket to store images.</p>
<p>The advantages of an S3 storage solution include near-infinite storage capacity, cost control with pay-as-you-go billing, high availability, and disaster recovery capabilities.</p>
<p>To use S3 for image storage, you need to modify the Harbor installation configuration in <code v-pre>values.yaml</code> during installation:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>expose:
  type: ingress
  tls:
    enabled: <span class="token boolean">true</span>
    certSource: secret
    secret:
      secretName: <span class="token string">"harbor-secret-tls"</span>
      notarySecretName: <span class="token string">"notary-secret-tls"</span>
  ingress:
    hosts:
      core: harbor.openim.io
      notary: notary.openim.io
    className: nginx
    annotations:
      kubernetes.io/tls-acme: <span class="token string">"true"</span>
persistence:
  imageChartStorage:
    type: s3
    s3:
      region: us-west-1
      bucket: bucketname
      accesskey: AWS_ACCESS_KEY_ID
      secretkey: AWS_SECRET_ACCESS_KEY
      rootdirectory: /harbor
  persistentVolumeClaim:
    chartmuseum:
      size: 10Gi
    jobservice:
      jobLog:
        size: 10Gi
      scanDataExports:
        size: 10Gi
     <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Make sure to replace the S3 configuration fields (<code v-pre>region</code>, <code v-pre>bucket</code>, <code v-pre>accesskey</code>, <code v-pre>secretkey</code>, and <code v-pre>rootdirectory</code>) with your actual values. Then, install Harbor using <code v-pre>helm install</code> with the <code v-pre>-f values.yaml</code> option.</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ helm <span class="token function">install</span> harbor harbor/harbor <span class="token parameter variable">-f</span> values.yaml <span class="token parameter variable">--namespace</span> harbor --create-namespace
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>With this configuration, Harbor will use S3 storage for images.</p>
<p>Congratulations! You have now completed the installation and configuration of Harbor, and you have the option to use S3 storage for your images if desired. Your Docker images can be securely stored and managed in your own Harbor image repository.</p>
<h2 id="end-é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#end-é“¾æ¥" aria-hidden="true">#</a> END é“¾æ¥</h2>
<ul><li><div><a href = '78.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '80.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>
<ul>
<li>
<p><RouterLink to="/">â“‚ï¸å›åˆ°ç›®å½•ğŸ </RouterLink></p>
</li>
<li>
<p><a href="https://nsddd.top/archives/contributors" target="_blank" rel="noopener noreferrer"><strong>ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–</strong><ExternalLinkIcon/></a>)</p>
</li>
<li>
<p>âœ´ï¸ç‰ˆæƒå£°æ˜ Â© ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª<a href="http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="noopener noreferrer">CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰Â©<ExternalLinkIcon/></a></p>
</li>
</ul>
</div></template>


