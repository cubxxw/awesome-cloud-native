<template><div><ul>
<li><a href="http://nsddd.top" target="_blank" rel="noopener noreferrer">author<ExternalLinkIcon/></a></li>
</ul>
<h1 id="ç¬¬21èŠ‚-minikube-å’Œ-kind" tabindex="-1"><a class="header-anchor" href="#ç¬¬21èŠ‚-minikube-å’Œ-kind" aria-hidden="true">#</a> ç¬¬21èŠ‚ Minikube å’Œ Kind</h1>
<div><a href = '20.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '22.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>
<blockquote>
<p>â¤ï¸ğŸ’•ğŸ’•æ–°æ—¶ä»£æ‹¥æŠ±äº‘åŸç”Ÿï¼Œäº‘åŸç”Ÿå…·æœ‰ç¯å¢ƒç»Ÿä¸€ã€æŒ‰éœ€ä»˜è´¹ã€å³å¼€å³ç”¨ã€ç¨³å®šæ€§å¼ºç‰¹ç‚¹ã€‚Myblog:<a href="http://nsddd.top/" target="_blank" rel="noopener noreferrer">http://nsddd.top<ExternalLinkIcon/></a></p>
</blockquote>
<hr>
<p>[TOC]</p>
<h2 id="å…³äº-minikube" tabindex="-1"><a class="header-anchor" href="#å…³äº-minikube" aria-hidden="true">#</a> å…³äº Minikube</h2>
<ul>
<li><a href="https://github.com/kubernetes/minikube" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/minikube<ExternalLinkIcon/></a></li>
</ul>
<ol>
<li><code v-pre>minikube</code>  æ˜¯å®˜æ–¹æ–‡æ¡£ä¸­çš„å…¥é—¨å·¥å…·ï¼Œä½†æ˜¯åŠŸèƒ½æœ‰é™ï¼Œæ‰€ä»¥åªæ˜¯å°è¯•ä¸€ä¸‹</li>
<li>minikube æ˜¯ä¸€ä¸ªå¯ä»¥æœ¬åœ°è¿è¡Œçš„å•æœºç‰ˆ <code v-pre>kubernetes</code> ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ å’Œè°ƒè¯•ç¨‹åº</li>
</ol>
<p>minikubeæ˜¯ä¸€ä¸ªKubernetes-SIGsé¡¹ç›®ï¼Œå·²ç»å¯åŠ¨ä¸‰å¹´å¤šäº†ã€‚å®ƒé‡‡ç”¨çš„æ–¹æ³•æ˜¯ç”Ÿæˆä¸€ä¸ªå®è´¨ä¸Šæ˜¯å•èŠ‚ç‚¹K8sé›†ç¾¤çš„VMã€‚ç”±äºå¯¹ä¸€ç³»åˆ—ç®¡ç†ç¨‹åºçš„æ”¯æŒï¼Œå®ƒå¯ä»¥åœ¨æ‰€æœ‰ä¸»è¦æ“ä½œç³»ç»Ÿä¸Šä½¿ç”¨ã€‚è¿™è¿˜å…è®¸æ‚¨å¹¶è¡Œåˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚</p>
<p>ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œminikubeæ˜¯ä¸€ä¸ªéå¸¸é€‚åˆåˆå­¦è€…çš„å·¥å…·ã€‚ä½¿ç”¨minikube startå¯åŠ¨é›†ç¾¤ï¼Œç¨ç­‰å‡ åˆ†é’Ÿï¼Œkubectlå°±å¯ä»¥å¼€å§‹äº†ã€‚è¦æŒ‡å®šKubernetesç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨--Kubernetes versionæ ‡å¿—ã€‚æ”¯æŒçš„ç‰ˆæœ¬åˆ—è¡¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚</p>
<p>å¦‚æœæ‚¨æ˜¯ kubernetes çš„æ–°æ‰‹ï¼Œminikubeæä¾›çš„å¯¹å…¶ä»ªè¡¨æ¿çš„ä¸€æµæ”¯æŒå¯èƒ½ä¼šå¸®åŠ©æ‚¨ã€‚ä½¿ç”¨ä¸€ä¸ªç®€å•çš„minikubeä»ªè¡¨æ¿ï¼Œåº”ç”¨ç¨‹åºå°†æ‰“å¼€ï¼Œè®©æ‚¨å¯¹é›†ç¾¤ä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ¦‚è¿°ã€‚è¿™æ˜¯é€šè¿‡minikubeçš„æ’ä»¶ç³»ç»Ÿå®ç°çš„ï¼Œè¯¥ç³»ç»Ÿå¯ä»¥å¸®åŠ©æ‚¨å°†è¯¸å¦‚Helmã€Nvidia gpuå’Œå›¾åƒæ³¨å†Œè¡¨ä¹‹ç±»çš„ä¸œè¥¿é›†æˆåˆ°é›†ç¾¤ä¸­ã€‚</p>
<h3 id="install" tabindex="-1"><a class="header-anchor" href="#install" aria-hidden="true">#</a> install</h3>
<blockquote>
<p>minikubeåœ¨macOSã€Linuxå’ŒWindowsä¸Šå®ç°æœ¬åœ°Kubernetesç¾¤é›†ã€‚minikubeçš„ä¸»è¦ç›®æ ‡æ˜¯æˆä¸ºæœ¬åœ°Kubernetesåº”ç”¨ç¨‹åºå¼€å‘çš„æœ€ä½³å·¥å…·ï¼Œå¹¶æ”¯æŒæ‰€æœ‰é€‚åˆçš„KubernetesåŠŸèƒ½ã€‚</p>
</blockquote>
<p><strong>å®‰è£… minikube éœ€è¦ä½¿ç”¨ docker æˆ–è€… è™šæ‹Ÿæœºï¼Œæˆ‘ä»¬ä½¿ç”¨ dockerï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>git clone https://github.com/kubernetes/minikube.git 
cd minikube 
make 
cd out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®‰è£…Kubernetes</strong></p>
<p>ä»å…·æœ‰ç®¡ç†å‘˜è®¿é—®æƒé™ï¼ˆä½†æœªä»¥rootç”¨æˆ·èº«ä»½ç™»å½•ï¼‰çš„ç»ˆç«¯è¿è¡Œï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>minikube start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨å·²ç»å®‰è£…äº†kubectlï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—®æ‚¨çš„æ–°é›†ç¾¤ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>kubectl get po <span class="token parameter variable">-A</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œ<code v-pre>minikube</code> å¯ä»¥ä¸‹è½½åˆé€‚ç‰ˆæœ¬çš„ <code v-pre>kubectl</code>ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿåƒè¿™æ ·ä½¿ç”¨å®ƒï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>minikube kubectl -- get po <span class="token parameter variable">-A</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‚¨è¿˜å¯ä»¥é€šè¿‡åœ¨shellé…ç½®ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹æ¥ç®€åŒ–æ‚¨çš„å·¥ä½œï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token builtin class-name">alias</span> <span class="token assign-left variable">kubectl</span><span class="token operator">=</span><span class="token string">"minikube kubectl --"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote>
<p>æœ€åˆï¼ŒæŸäº›æœåŠ¡ï¼ˆå¦‚å­˜å‚¨èµ„æºè°ƒé…ç¨‹åºï¼‰å¯èƒ½å°šæœªå¤„äºâ€œæ­£åœ¨è¿è¡Œâ€çŠ¶æ€ã€‚è¿™æ˜¯ç¾¤é›†å¯åŠ¨è¿‡ç¨‹ä¸­çš„æ­£å¸¸æƒ…å†µï¼Œå°†ç«‹å³è‡ªè¡Œè§£å†³ã€‚ä¸ºäº†æ›´æ·±å…¥åœ°äº†è§£æ‚¨çš„ç¾¤é›†çŠ¶æ€ï¼Œminikubeæ†ç»‘äº†Kubernetes Dashboardï¼Œä½¿æ‚¨èƒ½å¤Ÿè½»æ¾é€‚åº”æ–°ç¯å¢ƒï¼š</p>
</blockquote>
<h2 id="kind" tabindex="-1"><a class="header-anchor" href="#kind" aria-hidden="true">#</a> Kind</h2>
<p>Kindæ˜¯å¦ä¸€ä¸ªKubernetes SIGsé¡¹ç›®ï¼Œä½†ä¸minikubeç›¸æ¯”æœ‰å¾ˆå¤§ä¸åŒã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒå°†é›†ç¾¤ç§»åŠ¨åˆ°Dockerå®¹å™¨ä¸­ã€‚ä¸ç”ŸæˆVMç›¸æ¯”ï¼Œè¿™å°†æ˜¾è‘—åŠ å¿«å¯åŠ¨é€Ÿåº¦ã€‚</p>
<p>åˆ›å»ºé›†ç¾¤ä¸minikubeçš„æ–¹æ³•éå¸¸ç›¸ä¼¼ã€‚æ‰§è¡Œç±»åˆ›å»ºé›†ç¾¤ï¼Œç©ç­‰å¾…æ¸¸æˆï¼Œç„¶åä½ å°±å¯ä»¥èµ°äº†ã€‚é€šè¿‡ä½¿ç”¨ä¸åŒçš„åç§°ï¼ˆ-nameï¼‰kindï¼Œå¯ä»¥å¹¶è¡Œåˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚</p>
<p>æˆ‘ä¸ªäººå–œæ¬¢çš„ä¸€ä¸ªç‰¹æ€§æ˜¯èƒ½å¤Ÿå°†æœ¬åœ°å›¾åƒç›´æ¥åŠ è½½åˆ°é›†ç¾¤ä¸­ã€‚è¿™ä¸ºæˆ‘èŠ‚çœäº†ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥è®¾ç½®æ³¨å†Œè¡¨å’Œæ¯æ¬¡å°è¯•æ›´æ”¹æ—¶æ¨é€æˆ‘çš„å›¾åƒã€‚æœ‰äº†ä¸€ä¸ªç®€å•çš„ç±»å‹åŠ è½½dockerå›¾åƒæˆ‘çš„åº”ç”¨ç¨‹åºï¼šæœ€æ–°çš„å›¾åƒå¯ç”¨äºæˆ‘çš„é›†ç¾¤ã€‚å¾ˆä¸é”™çš„ï¼</p>
<p>å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ç§ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºKubernetesé›†ç¾¤çš„æ–¹æ³•ï¼Œè¯·å‹å¥½åœ°ï¼ˆæ‚¨å·²ç»ç­‰äº†å¾ˆä¹…äº†ï¼Œä¸æ˜¯å—ï¼šPï¼‰å‘å¸ƒå®ƒçš„GoåŒ…ï¼Œè¿™äº›åŒ…åœ¨hoodä¸‹ä½¿ç”¨ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šï¼Œè¯·æŸ¥çœ‹GoDocså¹¶æŸ¥çœ‹KUDOå¦‚ä½•ä½¿ç”¨kindè¿›è¡Œé›†æˆæµ‹è¯•ã€‚</p>
<h3 id="install-1" tabindex="-1"><a class="header-anchor" href="#install-1" aria-hidden="true">#</a> install</h3>
<p>Kubernetes å‘½ä»¤è¡Œå·¥å…· <a href="https://kubernetes.io/zh-cn/docs/reference/kubectl/kubectl/" target="_blank" rel="noopener noreferrer">kubectl<ExternalLinkIcon/></a>ï¼Œ è®©ä½ å¯ä»¥å¯¹ Kubernetes é›†ç¾¤è¿è¡Œå‘½ä»¤ã€‚ ä½ å¯ä»¥ä½¿ç”¨ kubectl æ¥éƒ¨ç½²åº”ç”¨ã€ç›‘æµ‹å’Œç®¡ç†é›†ç¾¤èµ„æºä»¥åŠæŸ¥çœ‹æ—¥å¿—ã€‚</p>
<p><a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer"><code v-pre>kind</code><ExternalLinkIcon/></a> è®©ä½ èƒ½å¤Ÿåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè¿è¡Œ Kubernetesã€‚ <code v-pre>kind</code> è¦æ±‚ä½ å®‰è£…å¹¶é…ç½®å¥½ <a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener noreferrer">Docker<ExternalLinkIcon/></a>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨ make å®‰è£…çš„æ–¹æ³•ï¼Œä½¿ç”¨ make ä¹Ÿæ˜¯é€‚åˆå¼€å‘è€…å®‰è£…çš„æ–¹æ¡ˆã€‚</p>
<p>ä½ åªéœ€è¦ <code v-pre>make</code> å’Œæ ‡å‡†çš„ç”¨æˆ·ç©ºé—´å·¥å…·å°±å¯ä»¥è¿è¡Œè¿™ä¸ªæ„å»ºï¼Œå®ƒä¼šè‡ªåŠ¨è·å¾—æ­£ç¡®çš„goç‰ˆæœ¬å’Œæˆ‘ä»¬æä¾›çš„ <code v-pre>gimmee</code> å‰¯æœ¬ã€‚</p>
<p>ç„¶åï¼Œæ‚¨å¯ä»¥è°ƒç”¨ <code v-pre>./bin/kind</code> æ¥ä½¿ç”¨å®ƒï¼Œæˆ–è€…å°† <code v-pre>bin/kind</code> å¤åˆ¶åˆ°ç³»ç»Ÿä¸­çš„æŸä¸ªç›®å½•ä¸­ <code v-pre>PATH</code> ï¼Œä»¥ä¾¿ä»å‘½ä»¤è¡Œå°†å…¶ç”¨ä½œ <code v-pre>kind</code> ã€‚</p>
<p><code v-pre>make install</code> å°†å°è¯•æ¨¡æ‹Ÿ <code v-pre>go install</code> ï¼Œå¹¶å…·æœ‰ä¸ä¸‹é¢çš„ <code v-pre>go install</code> ç›¸åŒçš„è·¯å¾„è¦æ±‚ã€‚</p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>git clone https://github.com/kubernetes-sigs/kind
cd kind 
make build 
cd bin
./kind
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="use-kind" tabindex="-1"><a class="header-anchor" href="#use-kind" aria-hidden="true">#</a> Use Kind</h3>
<p>è¦ä½¿ç”¨ kindï¼Œæ‚¨éœ€è¦å®‰è£… docker .è¿è¡Œ docker åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å†…å®¹åˆ›å»ºé›†ç¾¤ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>â¯ kind create cluster
â¯ ./kind create cluster <span class="token parameter variable">--name</span> kind-2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªé›†ç¾¤</p>
</blockquote>
<p><strong>è¦åˆ é™¤ç¾¤é›†ï¼Œè¯·ä½¿ç”¨ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>â¯ ./kind delete cluster
Deleting cluster "kind" ...
â¯ ./kind delete cluster --name kind-2
Deleting cluster "kind-2" ...

â¯ ./kind get clusters
No kind clusters found.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>å¦‚æœæœªæŒ‡å®šæ ‡å¿— <code v-pre>--name</code> ï¼Œåˆ™ kind å°†ä½¿ç”¨é»˜è®¤ç¾¤é›†ä¸Šä¸‹æ–‡åç§° <code v-pre>kind</code> å¹¶åˆ é™¤è¯¥ç¾¤é›†ã€‚</p>
</blockquote>
<p><strong>æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ï¼š</strong></p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>â¯ kubectl cluster-info
Kubernetes control plane is running at https://127.0.0.1:37949
KubeDNS is running at https://127.0.0.1:37949/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>Kind éƒ¨ç½²é›†ç¾¤çš„ Kubernetes ç«¯å£é»˜è®¤æ˜¯ 37949 ç«¯å£ï¼Œè€Œ Kubernetes é»˜è®¤ master æ˜¯ 6443</p>
</blockquote>
<p>è®¿é—®ç«¯å£ï¼š</p>
<p><img src="http://sm.nsddd.top/sm202303171022581.png" alt="image-20230317102243422"></p>
<p><strong>å¯ä»¥çœ‹åˆ°Windowsæµè§ˆå™¨å¯ä»¥æ‰“å¼€ WSL ä¸­éƒ¨ç½²çš„é›†ç¾¤ï¼Œè¿™æ­£æ˜¯ WSL2 é›†æˆ docker Desktop for Windows çš„çœŸæ­£ä¼˜åŠ¿ã€‚</strong></p>
<p><strong>è·å–é›†ç¾¤</strong>ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>â¯ ./kind get clusters
kind
kind-2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºäº†ä¸ç‰¹å®šé›†äº’ï¼Œæ‚¨åªéœ€åœ¨ kubectl ä¸­å°†é›†ç¾¤åç§°æŒ‡å®šä¸ºä¸Šä¸‹æ–‡ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>â¯ kubectl cluster-info <span class="token parameter variable">--context</span> kind-kind
Kubernetes control plane is running at https://127.0.0.1:45125
CoreDNS is running at https://127.0.0.1:45125/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="token string">'kubectl cluster-info dump'</span><span class="token builtin class-name">.</span>

â¯ kubectl cluster-info <span class="token parameter variable">--context</span> kind-kind-2

Kubernetes control plane is running at https://127.0.0.1:37653
CoreDNS is running at https://127.0.0.1:37653/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="token string">'kubectl cluster-info dump'</span><span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kindçš„å¤šèŠ‚ç‚¹é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#kindçš„å¤šèŠ‚ç‚¹é›†ç¾¤" aria-hidden="true">#</a> Kindçš„å¤šèŠ‚ç‚¹é›†ç¾¤</h3>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å°è¯•åˆ›å»ºä¸€ä¸ªå¤šèŠ‚ç‚¹é›†ç¾¤ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">></span> kind-3nodes.yaml</span>
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
  - role: control-plane
  - role: worker
  - role: worker
EOF</span>

kind create cluster <span class="token parameter variable">--name</span> wslkindmultinodes <span class="token parameter variable">--config</span> ./kind-3nodes.yaml

kubectl get nodes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kind-åˆ›å»ºä»ªè¡¨æ¿" tabindex="-1"><a class="header-anchor" href="#kind-åˆ›å»ºä»ªè¡¨æ¿" aria-hidden="true">#</a> Kindï¼šåˆ›å»ºä»ªè¡¨æ¿</h3>
<p>ä½¿ç”¨å‘½ä»¤è¡Œå·¥ä½œæ˜¯ä¸€ä»¶å¥½äº‹ã€‚ä½†æ˜¯ï¼Œåœ¨å¤„ç†Kubernetesæ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶å¯èƒ½å¸Œæœ›æœ‰ä¸€ä¸ªç›´è§‚çš„æ¦‚è§ˆã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª<a href="https://link.zhihu.com/?target=https%3A//github.com/kubernetes/dashboard" target="_blank" rel="noopener noreferrer">Kubernetes Dashboard<ExternalLinkIcon/></a>é¡¹ç›®ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-rc6/aio/deploy/recommended.yaml

kubectl get all <span class="token parameter variable">-n</span> kubernetes-dashboard
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½¿ç”¨ClusterIPåˆ›å»ºæœåŠ¡æ—¶ï¼Œåœ¨Windowsæµè§ˆå™¨ä¸­é”®å…¥URLï¼Œåˆ™æ— æ³•è®¿é—®è¯¥æœåŠ¡ï¼š</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä¸´æ—¶ä»£ç†ï¼š</p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>kubectl proxy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥å¯ä»¥è®¿é—®:</p>
<p><a href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/" target="_blank" rel="noopener noreferrer">http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/<ExternalLinkIcon/></a></p>
<p>æ¥ä¸‹æ¥æ˜¯ç™»å½•ï¼š</p>
<p><strong>æˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªä»¤ç‰Œï¼Œä¹Ÿå¯ä»¥è¾“å…¥æ¥è‡ªé›†ç¾¤çš„kubeconfigæ–‡ä»¶ã€‚</strong></p>
<p>å¦‚æœå°è¯•ä½¿ç”¨kubeconfigç™»å½•ï¼Œåˆ™å°†æ˜¾ç¤ºé”™è¯¯â€œ Internal error (500): Not enough data to create auth info structure â€ã€‚è¿™æ˜¯ç”±äºkubeconfigæ–‡ä»¶ä¸­ç¼ºå°‘å‡­æ®ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºé¿å…å‡ºç°ä»¥ä¸Šçš„é”™è¯¯ï¼Œè¯·ä½¿ç”¨<a href="https://link.zhihu.com/?target=https%3A//github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md" target="_blank" rel="noopener noreferrer">æ¨èçš„RBACæ–¹æ³•<ExternalLinkIcon/></a>ã€‚</p>
<p>è®©æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªæ–°çš„WSL2ä¼šè¯ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment"># Create a new ServiceAccount</span>
kubectl apply <span class="token parameter variable">-f</span> - <span class="token operator">&lt;&lt;</span><span class="token string">EOF
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kubernetes-dashboard
EOF</span>
<span class="token comment"># Create a ClusterRoleBinding for the ServiceAccount</span>
kubectl apply <span class="token parameter variable">-f</span> - <span class="token operator">&lt;&lt;</span><span class="token string">EOF
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: admin-user
  namespace: kubernetes-dashboard
EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>kubectl <span class="token parameter variable">-n</span> kubernetes-dashboard describe secret <span class="token variable"><span class="token variable">$(</span>kubectl <span class="token parameter variable">-n</span> kubernetes-dashboard get secret <span class="token operator">|</span> <span class="token function">grep</span> admin-user <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">)</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/sm202303171034444.png" alt="image-20230317103458214"></p>
<p>å†è®¿é—®ï¼šhttp://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</p>
<p>æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸Šé¢ç”Ÿæˆçš„ Tokenï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>eyJhbGciOiJSUzI1NiIsImtpZCI6ImpOcy1RQ0Rack9QYlJueHQ5YldYM25rVjZWN2VPUkhaUUJJWUl1SDFQaFkifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXRkOGttIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJkYmM3YjJhYi0zZjBhLTRiODItYjJmNC1mODg2OGI3ZjEzNmQiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.awBu9cBxgphOEc4kNIVCbfHWBhZW7Iz5pgOk0v_YElmGk86mQ5Y-bPwko7pRyGB-d92sbkYoeW3Y5fucUeBtM-jAHRhxaZWs3eP6V_EMKA7olkW73CyXzmuLzhInyv1K23t3pUXDyar8lPBVOO1ZKmD_eP5pCt7wVqPyy4sJy3tvIscKeg76gBG-PG7D9zt7_x_7eHCPS0Zgo1GjV5q3SHWv8JrJX9E11uVafoYLe5y4EZKcFsGBvOcIYKuDkFg4rmz4OMsxKuLmlSpys_wQl5DGg6xAq14kY6qumCx6xYMqAW979tCRp61R3lmW1cuqUEvBlkvCo74EX0PRQ19MNA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åæˆ‘ä»¬å°±è¿›æ¥äº†ï¼š</p>
<p><img src="http://sm.nsddd.top/sm202303171040950.png" alt="image-20230317104014702"></p>
<h2 id="å’Œk3sæ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#å’Œk3sæ¯”è¾ƒ" aria-hidden="true">#</a> å’Œk3sæ¯”è¾ƒ</h2>
<p>æˆ‘åšäº†å¤§é‡å…³äº k3s  çš„æ–‡ç« ï¼Œç”šè‡³è¯¦ç»†ä¸äºšäºå®˜æ–¹çš„æ–‡æ¡£ã€‚</p>
<ul>
<li>https://docker.nsddd.top/Cloud-Native-k8s/14.html</li>
<li>https://docker.nsddd.top/Cloud-Native-k8s/15.html</li>
<li>https://docker.nsddd.top/Cloud-Native-k8s/27.html</li>
</ul>
<p>K3sæ˜¯ç”± rancher å®éªŒå®¤å¼€å‘çš„Kubernetesçš„ç¼©å°ç‰ˆã€‚é€šè¿‡åˆ é™¤å¯æœ‰å¯æ— çš„ç‰¹æ€§ï¼ˆä¼ ç»Ÿçš„ã€alphaçš„ã€éé»˜è®¤çš„æ ‘å†…æ’ä»¶ï¼‰å’Œä½¿ç”¨è½»é‡çº§ç»„ä»¶ï¼ˆä¾‹å¦‚sqlite3è€Œä¸æ˜¯etcd3ï¼‰ï¼Œå®ƒä»¬å®ç°äº†æ˜¾è‘—çš„ç²¾ç®€ã€‚è¿™å°†äº§ç”Ÿä¸€ä¸ªå¤§å°çº¦ä¸º60MBçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">minikube</th>
<th style="text-align:left">kind</th>
<th style="text-align:left">k3s</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">runtime</td>
<td style="text-align:left">VM</td>
<td style="text-align:left">container</td>
<td>native</td>
</tr>
<tr>
<td style="text-align:left">supported architectures</td>
<td style="text-align:left">AMD64</td>
<td style="text-align:left">AMD64</td>
<td>AMD64, ARMv7, ARM64</td>
</tr>
<tr>
<td style="text-align:left">supported container runtimes</td>
<td style="text-align:left">Docker,CRI-O,containerd,gvisor</td>
<td style="text-align:left">Docker</td>
<td>Docker, containerd</td>
</tr>
<tr>
<td style="text-align:left">startup time initial/following</td>
<td style="text-align:left">5:19 / 3:15</td>
<td style="text-align:left">2:48 / 1:06</td>
<td>0:15 / 0:15</td>
</tr>
<tr>
<td style="text-align:left">memory requirements</td>
<td style="text-align:left">2GB</td>
<td style="text-align:left">8GB (Windows, MacOS)</td>
<td>512 MB</td>
</tr>
<tr>
<td style="text-align:left">requires root?</td>
<td style="text-align:left">no</td>
<td style="text-align:left">no</td>
<td>yes (rootless is experimental)</td>
</tr>
<tr>
<td style="text-align:left">multi-cluster support</td>
<td style="text-align:left">yes</td>
<td style="text-align:left">yes</td>
<td>no (can be achieved using containers)</td>
</tr>
<tr>
<td style="text-align:left">multi-node support</td>
<td style="text-align:left">no</td>
<td style="text-align:left">yes</td>
<td>yes</td>
</tr>
<tr>
<td style="text-align:left">project page</td>
<td style="text-align:left"><a href="https://minikube.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">minikube<ExternalLinkIcon/></a></td>
<td style="text-align:left"><a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">kind<ExternalLinkIcon/></a></td>
<td><a href="https://k3s.io/" target="_blank" rel="noopener noreferrer">k3s<ExternalLinkIcon/></a></td>
</tr>
</tbody>
</table>
<h2 id="end-é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#end-é“¾æ¥" aria-hidden="true">#</a> END é“¾æ¥</h2>
<ul><li><div><a href = '20.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '22.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>
<ul>
<li>
<p><RouterLink to="/">â“‚ï¸å›åˆ°ç›®å½•ğŸ </RouterLink></p>
</li>
<li>
<p><a href="https://nsddd.top/archives/contributors" target="_blank" rel="noopener noreferrer"><strong>ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–</strong><ExternalLinkIcon/></a>)</p>
</li>
<li>
<p>âœ´ï¸ç‰ˆæƒå£°æ˜ Â© ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª<a href="http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="noopener noreferrer">CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰Â©<ExternalLinkIcon/></a></p>
</li>
</ul>
</div></template>


