<template><div><ul>
<li><a href="http://nsddd.top" target="_blank" rel="noopener noreferrer">author<ExternalLinkIcon/></a></li>
</ul>
<h1 id="ç¬¬75èŠ‚-openim-ç¦»çº¿å®‰è£…è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#ç¬¬75èŠ‚-openim-ç¦»çº¿å®‰è£…è®¾è®¡" aria-hidden="true">#</a> ç¬¬75èŠ‚ OpenIM ç¦»çº¿å®‰è£…è®¾è®¡</h1>
<div><a href = '74.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '76.md' style='float: right'>  â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div>
<br>
<blockquote>
<p>â¤ï¸ğŸ’•ğŸ’•è®°å½•<a href="https://github.com/cubxxw/sealos" target="_blank" rel="noopener noreferrer">sealos<ExternalLinkIcon/></a>å¼€æºé¡¹ç›®çš„å­¦ä¹ è¿‡ç¨‹ã€‚<a href="https://github.com/cubxxw/sealos" target="_blank" rel="noopener noreferrer">k8s,dockerå’Œäº‘åŸç”Ÿçš„å­¦ä¹ <ExternalLinkIcon/></a>ã€‚Myblog:<a href="http://nsddd.top/" target="_blank" rel="noopener noreferrer">http://nsddd.top<ExternalLinkIcon/></a></p>
</blockquote>
<hr>
<p>[TOC]</p>
<h1 id="ç¦»çº¿å®‰è£…" tabindex="-1"><a class="header-anchor" href="#ç¦»çº¿å®‰è£…" aria-hidden="true">#</a> ç¦»çº¿å®‰è£…</h1>
<h3 id="æµ‹è¯•ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•ç¯å¢ƒ" aria-hidden="true">#</a> æµ‹è¯•ç¯å¢ƒ</h3>
<p>éªŒè¯ç¦»çº¿å®‰è£…çš„ç¯å¢ƒæ˜¯å¦æ­£ç¡®ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>ubuntu@VM-0-14-ubuntu:~/workspaces$ <span class="token function">docker</span> version
Client: Docker Engine - Community
 Version:           <span class="token number">20.10</span>.14
 API version:       <span class="token number">1.41</span>
 Go version:        go1.16.15
 Git commit:        a224086
 Built:             Thu Mar <span class="token number">24</span> 01:47:57 <span class="token number">2022</span>
 OS/Arch:           linux/amd64
 Context:           default
 Experimental:      <span class="token boolean">true</span>

Server: Docker Engine - Community
 Engine:
  Version:          <span class="token number">20.10</span>.14
  API version:      <span class="token number">1.41</span> <span class="token punctuation">(</span>minimum version <span class="token number">1.12</span><span class="token punctuation">)</span>
  Go version:       go1.16.15
  Git commit:       87a90dc
  Built:            Thu Mar <span class="token number">24</span> 01:45:46 <span class="token number">2022</span>
  OS/Arch:          linux/amd64
  Experimental:     <span class="token boolean">false</span>
 containerd:
  Version:          <span class="token number">1.5</span>.11
  GitCommit:        3df54a852345ae127d1fa3092b95168e4a88e2f8
 runc:
  Version:          <span class="token number">1.0</span>.3
  GitCommit:        v1.0.3-0-gf46b6ba
 docker-init:
  Version:          <span class="token number">0.19</span>.0
  GitCommit:        de40ad0
ubuntu@VM-0-14-ubuntu:~/workspaces$ <span class="token function">docker-compose</span> version
<span class="token function">docker-compose</span> version <span class="token number">1.24</span>.1, build 4667896b
docker-py version: <span class="token number">3.7</span>.3
CPython version: <span class="token number">3.6</span>.8
OpenSSL version: OpenSSL <span class="token number">1.1</span>.0j  <span class="token number">20</span> Nov <span class="token number">2018</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®‰è£…åŒ…å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#å®‰è£…åŒ…å‡†å¤‡" aria-hidden="true">#</a> å®‰è£…åŒ…å‡†å¤‡</h3>
<p>é•œåƒä¸‹è½½ï¼š</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">wget</span> <span class="token operator">&lt;</span>http://59.36.173.89:9090/api/v1/buckets/app/objects/download?prefix<span class="token operator">=</span>ZG9ja2Vy56a757q/5a6J6KOFLnJhcg<span class="token operator">==</span><span class="token operator">></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å®‰è£…çš„é€»è¾‘ï¼š</strong> 1. å¯ä»¥ä½¿ç”¨ docker å®‰è£… 2. ä½¿ç”¨ docker-compopse</p>
<h3 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> docker-compose</h3>
<ol>
<li>å…ˆæŠŠimçš„docker-composeé…ç½®æ³¨é‡Šæ‰ï¼Œç”¨dockerå®‰è£…ç»„ä»¶ã€‚</li>
<li>å†æºç ç¼–è¯‘im serverï¼Œå¯åŠ¨im</li>
</ol>
<h2 id="ç¯å¢ƒå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒå‡†å¤‡" aria-hidden="true">#</a> ç¯å¢ƒå‡†å¤‡</h2>
<h3 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> mysql</h3>
<blockquote>
<p>åœ¨çº¿çš„ç¯å¢ƒå‡†å¤‡</p>
</blockquote>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">-v</span> /my/own/datadir:/var/lib/mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>password <span class="token parameter variable">-d</span> mysql:5.7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…mongodb" tabindex="-1"><a class="header-anchor" href="#å®‰è£…mongodb" aria-hidden="true">#</a> å®‰è£…MongoDB</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">27017</span>:27017 <span class="token parameter variable">--name</span> mongo <span class="token parameter variable">-v</span> /my/own/datadir:/data/db <span class="token parameter variable">-e</span> <span class="token assign-left variable">MONGO_INITDB_ROOT_USERNAME</span><span class="token operator">=</span>root <span class="token parameter variable">-e</span> <span class="token assign-left variable">MONGO_INITDB_ROOT_PASSWORD</span><span class="token operator">=</span>password <span class="token punctuation">\</span><span class="token punctuation">\</span>-d mongo:4.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…-redis" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-redis" aria-hidden="true">#</a> å®‰è£… redis</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">--name</span> redis <span class="token parameter variable">-v</span> /my/own/datadir:/data <span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PASSWORD</span><span class="token operator">=</span>password <span class="token parameter variable">-d</span> redis:5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…zookeeper" tabindex="-1"><a class="header-anchor" href="#å®‰è£…zookeeper" aria-hidden="true">#</a> å®‰è£…Zookeeper:</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run  <span class="token parameter variable">-p</span> <span class="token number">2181</span>:2181 <span class="token parameter variable">--name</span> zookeeper <span class="token parameter variable">-d</span> wombat/zookeeper
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…kafka" tabindex="-1"><a class="header-anchor" href="#å®‰è£…kafka" aria-hidden="true">#</a> å®‰è£…Kafka:</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">9092</span>:9092 <span class="token parameter variable">--name</span> kafka <span class="token parameter variable">--link</span> zookeeper <span class="token parameter variable">-e</span> <span class="token assign-left variable">KAFKA_ADVERTISED_LISTENERS</span><span class="token operator">=</span>PLAINTEXT://:9092 <span class="token parameter variable">-e</span> <span class="token assign-left variable">KAFKA_ZOOKEEPER_CONNECT</span><span class="token operator">=</span>zookeeper:2181 <span class="token parameter variable">-e</span> <span class="token assign-left variable">KAFKA_LISTENERS</span><span class="token operator">=</span>PLAINTEXT://:9092 <span class="token parameter variable">-d</span> wurstmeister/kafka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…etcd" tabindex="-1"><a class="header-anchor" href="#å®‰è£…etcd" aria-hidden="true">#</a> å®‰è£…Etcd:</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">2379</span>:2379 <span class="token parameter variable">-p</span> <span class="token number">2380</span>:2380 <span class="token parameter variable">--name</span> etcd <span class="token parameter variable">-d</span> quay.io/coreos/etcd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å®‰è£…minio" tabindex="-1"><a class="header-anchor" href="#å®‰è£…minio" aria-hidden="true">#</a> å®‰è£…MinIO:</h3>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">9000</span>:9000 <span class="token parameter variable">--name</span> minio <span class="token parameter variable">-v</span> /mnt/data:/data <span class="token parameter variable">-e</span> <span class="token string">"MINIO_ROOT_USER=<span class="token variable">${<span class="token environment constant">USER</span>}</span>"</span> <span class="token parameter variable">-e</span> <span class="token string">"MINIO_ROOT_PASSWORD=<span class="token variable">${PASSWORD}</span>"</span> <span class="token parameter variable">-d</span> minio/minio server /data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="ç¦»çº¿å®‰è£…ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¦»çº¿å®‰è£…ä¸­é—´ä»¶" aria-hidden="true">#</a> <strong>ç¦»çº¿å®‰è£…ä¸­é—´ä»¶</strong></h2>
<ol>
<li>scp images.tar.gzåˆ°æœåŠ¡å™¨ï¼Œ å¹¶ä¸”è§£å‹æ–‡ä»¶</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> ./images.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol>
<li>åŠ è½½æ¯ä¸ªé•œåƒåˆ°dockeré‡Œé¢</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> etcd.tar  grafana.tar  kafka.tar  minio.tar  mongo.tar  mysql.tar  node-exporter.tar  promethues.tar  redis.tar  zookeeper.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>docker æœ¬åœ°é•œåƒå¯¼å…¥ï¼š</strong></p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./etcd.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./grafana.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./kafka.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./minio.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./mongo.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./mysql.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./node-exporter.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./promethues.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./redis.tar<span class="token punctuation">;</span>
 <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./zookeeper.tar<span class="token punctuation">;</span>
<span class="token comment"># ---</span>
<span class="token comment"># OR -</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">img</span> <span class="token keyword">in</span> etcd.tar grafana.tar kafka.tar minio.tar mongo.tar mysql.tar node-exporter.tar promethues.tar redis.tar zookeeper.tar<span class="token punctuation">;</span> 
<span class="token keyword">do</span>
    <span class="token function">docker</span> load <span class="token parameter variable">-i</span> ./<span class="token variable">$img</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol>
<li>éªŒè¯å¯¼å…¥</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token keyword">for</span> <span class="token for-or-select variable">image</span> <span class="token keyword">in</span> etcd grafana kafka minio mongo mysql node-exporter prometheus redis zookeeper<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token variable">$image</span> <span class="token operator">></span> /dev/null
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$image</span> é•œåƒå¯¼å…¥å¤±è´¥!"</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$image</span> é•œåƒå¯¼å…¥æˆåŠŸ!"</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç¼–è¯‘" tabindex="-1"><a class="header-anchor" href="#ç¼–è¯‘" aria-hidden="true">#</a> ç¼–è¯‘</h2>
<p>https://github.com/OpenIMSDK/Open-IM-Server-Enterprise.git</p>
<p><strong>ä¸­é—´ä»¶æ•°æ®åº“å¯åŠ¨</strong></p>
<ol>
<li>
<p>è¿›å…¥ <code v-pre>Open-IM-Server-Enterprise</code> ç›®å½•ä¸‹æŠŠ <code v-pre>docker-compose.yaml</code> æ›¿æ¢æˆè¯¥æ–‡æ¡£ç›®å½•ä¸‹çš„ <code v-pre>docker-compose.yaml</code></p>
<div class="language-jsx ext-jsx line-numbers-mode"><pre v-pre class="language-jsx"><code>git clone <span class="token operator">-</span>b v2<span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">.</span>0release <span class="token operator">&lt;</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>OpenIMSDK<span class="token operator">/</span>Open<span class="token operator">-</span><span class="token constant">IM</span><span class="token operator">-</span>Server<span class="token operator">-</span>Enterprise<span class="token operator">></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li>
<li>
<p>å¯åŠ¨ä¸­é—´ä»¶æ•°æ®åº“</p>
</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> <span class="token function">docker-compose</span> up -d<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å¯åŠ¨imæœ¬ä½“" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨imæœ¬ä½“" aria-hidden="true">#</a> <strong>å¯åŠ¨IMæœ¬ä½“</strong></h3>
<ol>
<li>å¯åŠ¨</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> ./start_all.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol>
<li>æ£€æŸ¥æ˜¯å¦æˆåŠŸ</li>
</ol>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code> ./check_all.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="å¯åŠ¨å…¶ä»–ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨å…¶ä»–ç»„ä»¶" aria-hidden="true">#</a> <strong>å¯åŠ¨å…¶ä»–ç»„ä»¶</strong></h3>
<ol>
<li>å¯åŠ¨å…¶ä»–ç»„ä»¶å¦‚åŠ å¯†ï¼Œopen-im-enterpriseï¼ŒæŒ‰ä¹‹å‰æ–‡æ¡£æ¥å¯åœã€‚</li>
</ol>
<h2 id="éŸ³è§†é¢‘äºŒè¿›åˆ¶" tabindex="-1"><a class="header-anchor" href="#éŸ³è§†é¢‘äºŒè¿›åˆ¶" aria-hidden="true">#</a> éŸ³è§†é¢‘äºŒè¿›åˆ¶</h2>
<h2 id="demo-å®‰è£…ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#demo-å®‰è£…ä¸‹è½½" aria-hidden="true">#</a> demo å®‰è£…ä¸‹è½½</h2>
<p><strong>Edit on github</strong></p>
<h3 id="ç›´æ¥ä¸‹è½½app" tabindex="-1"><a class="header-anchor" href="#ç›´æ¥ä¸‹è½½app" aria-hidden="true">#</a> <strong><a href="https://doc.rentsoft.cn/#/flutter_v2/sdk_integrate/development?id=%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BDapp" target="_blank" rel="noopener noreferrer">ç›´æ¥ä¸‹è½½app<ExternalLinkIcon/></a></strong></h3>
<p>https://www.pgyer.com/app/qrcode/OpenIM</p>
<p>å¯é€‰æ‹©æ›¿æ¢æœåŠ¡å™¨åœ°å€ä¸ºè‡ªå·±æ­å»ºçš„æœåŠ¡å™¨åœ°å€ï¼Œé»˜è®¤åœ°å€ä¸ºå®˜æ–¹æœåŠ¡å™¨åœ°å€</p>
<h2 id="end-é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#end-é“¾æ¥" aria-hidden="true">#</a> END é“¾æ¥</h2>
<ul><li><div><a href = '74.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—  </a><a href = '76.md' style='float: right'>  ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>
<ul>
<li>
<p><RouterLink to="/">â“‚ï¸å›åˆ°ç›®å½•ğŸ </RouterLink></p>
</li>
<li>
<p><a href="https://nsddd.top/archives/contributors" target="_blank" rel="noopener noreferrer"><strong>ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–</strong><ExternalLinkIcon/></a>)</p>
</li>
<li>
<p>âœ´ï¸ç‰ˆæƒå£°æ˜ Â© ï¼šæœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª<a href="http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="noopener noreferrer">CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰Â©<ExternalLinkIcon/></a></p>
</li>
</ul>
</div></template>


